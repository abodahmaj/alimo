<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>بطولة مجمع الثقافة للألعاب الإلكترونية - مركز القيادة</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;900&family=Orbitron:wght@700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <style>
        :root {
            --bg-dark: #0A0A0E;
            --bg-medium: #1A1A22;
            --bg-light: #2A2A35;
            --text-primary: #E0E0E0;
            --text-secondary: #A0A0A0;
            --neon-blue: #00FFFF;
            --neon-green: #00FF00;
            --neon-orange: #FF8C00;
            --neon-purple: #B026FF;
            --glow-intensity: 0 0 8px;
            
            /* Touch-friendly sizes */
            --touch-target-min: 48px;
            --touch-spacing: 12px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: rgba(0, 255, 255, 0.2);
        }
        
        html {
            font-size: 16px;
            -webkit-text-size-adjust: 100%;
            -ms-text-size-adjust: 100%;
        }
        
        html, body {
            overscroll-behavior-x: none;
            overscroll-behavior-y: auto;
            scroll-behavior: smooth;
            touch-action: pan-y pinch-zoom;
        }
        
        body {
            font-family: 'Tajawal', sans-serif;
            background: linear-gradient(135deg, #0A0A0E 0%, #1A1425 50%, #0A0A0E 100%);
            color: var(--text-primary);
            position: relative;
            overflow-x: hidden;
            min-height: 100vh;
        }
        
        /* خلفية متحركة محسّنة للموبايل */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(0,255,255,0.12) 0%, transparent 30%),
                radial-gradient(circle at 80% 80%, rgba(255,140,0,0.1) 0%, transparent 30%);
            z-index: 0;
            pointer-events: none;
            will-change: transform;
        }
        
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                url('data:image/svg+xml;utf8,<svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg"><defs><pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse"><path d="M 40 0 L 0 0 0 40" fill="none" stroke="%23151520" stroke-width="0.5" opacity="0.3"/></pattern></defs><rect width="100%" height="100%" fill="url(%23grid)"/></svg>') center / 40px 40px;
            opacity: 0.3;
            z-index: 0;
            pointer-events: none;
        }

        /* شريط التقدم العلوي */
        .progress-bar-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: rgba(255,255,255,0.05);
            z-index: 100;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, 
                var(--neon-blue) 0%, 
                var(--neon-purple) 50%, 
                var(--neon-orange) 100%);
            box-shadow: 
                0 0 15px var(--neon-blue),
                0 0 30px var(--neon-purple);
            transition: width 0.5s ease;
            will-change: width;
        }

        h1, h2, h3, .stat-value {
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 1px;
        }
        
        .player-name {
            font-family: 'Share Tech Mono', monospace;
        }
        
        /* شريط التنقل - محسّن للموبايل */
        .top-nav {
            background: rgba(26, 26, 34, 0.95);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border-bottom: 2px solid rgba(0,255,255,0.3);
            box-shadow: 
                0 4px 16px rgba(0,0,0,0.3),
                0 0 20px rgba(0,255,255,0.1);
            z-index: 50;
            position: sticky;
            top: 0;
        }
        
        .nav-link {
            border-bottom: 3px solid transparent;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            text-shadow: none;
            position: relative;
            overflow: hidden;
            min-height: var(--touch-target-min);
            display: flex;
            align-items: center;
            justify-content: center;
            touch-action: manipulation;
        }
        
        .nav-link::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            width: 0;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--neon-blue), transparent);
            transform: translateX(-50%);
            transition: width 0.3s ease;
            box-shadow: 0 0 10px var(--neon-blue);
        }
        
        .nav-link:active {
            transform: scale(0.97);
        }
        
        .nav-link:hover::before,
        .nav-link.active::before {
            width: 100%;
        }
        
        .nav-link.active, .nav-link:hover {
            color: var(--neon-blue);
            text-shadow: 
                0 0 10px var(--neon-blue),
                0 0 20px var(--neon-blue);
        }
        
        /* بطاقات محسّنة للموبايل */
        .glass-card {
            background: rgba(42, 42, 53, 0.85);
            backdrop-filter: blur(12px) saturate(150%);
            -webkit-backdrop-filter: blur(12px) saturate(150%);
            border-radius: 16px;
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 
                0 4px 16px rgba(0,0,0,0.3),
                inset 0 1px 0 rgba(255,255,255,0.1),
                0 0 15px rgba(0,255,255,0.1);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            touch-action: manipulation;
        }
        
        .glass-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(0,255,255,0.1),
                transparent
            );
            transition: left 0.5s ease;
        }
        
        .glass-card:active::before {
            left: 100%;
        }
        
        .glass-card:active {
            transform: scale(0.98);
        }
        
        .stat-icon {
            font-size: 2rem;
            opacity: 0.15;
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            transition: all 0.3s ease;
        }

        .stat-value {
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: drop-shadow(0 0 15px rgba(0,255,255,0.5));
        }
        
        /* بطاقة البطل */
        .champion-card {
            background: rgba(42, 42, 53, 0.9);
            backdrop-filter: blur(15px) saturate(180%);
            -webkit-backdrop-filter: blur(15px) saturate(180%);
            border-radius: 20px;
            border: 2px solid rgba(0,255,0,0.3);
            box-shadow: 
                0 8px 32px rgba(0,0,0,0.4),
                inset 0 1px 0 rgba(255,255,255,0.15),
                0 0 40px rgba(0,255,0,0.2);
            position: relative;
            overflow: hidden;
        }
        
        .champion-card::after {
            content: '';
            position: absolute;
            inset: 2px;
            background: rgba(10,10,14,0.85);
            backdrop-filter: blur(8px);
            border-radius: 18px;
            z-index: 1;
        }
        
        .champion-card > * {
            position: relative;
            z-index: 2;
        }
        
        .champion-display {
            color: var(--neon-green);
            text-shadow: 
                0 0 10px var(--neon-green),
                0 0 20px var(--neon-green),
                0 0 30px var(--neon-green);
            word-break: break-word;
        }

        /* حاوية البراكيت - محسّنة للموبايل */
        .bracket-container {
            display: flex;
            overflow-x: auto;
            overflow-y: hidden;
            padding: 2rem 1rem;
            background: rgba(10,10,14,0.8);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(0,255,255,0.2);
            border-radius: 12px;
            box-shadow: 
                inset 0 0 40px rgba(0,0,0,0.5),
                0 4px 16px rgba(0,0,0,0.3);
            position: relative;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: thin;
            scrollbar-color: rgba(0,255,255,0.5) rgba(255,255,255,0.1);
        }
        
        .bracket-container::-webkit-scrollbar {
            height: 6px;
        }
        
        .bracket-container::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.05);
            border-radius: 3px;
        }
        
        .bracket-container::-webkit-scrollbar-thumb {
            background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
            border-radius: 3px;
            box-shadow: 0 0 8px var(--neon-blue);
        }
        
        .round {
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            margin-right: 60px;
            position: relative;
            min-height: 300px;
        }
        
        .round-label {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,255,255,0.15);
            color: var(--neon-blue);
            padding: 6px 14px;
            border-radius: 16px;
            font-size: 0.8rem;
            font-family: 'Orbitron', sans-serif;
            border: 1px solid rgba(0,255,255,0.3);
            white-space: nowrap;
            text-shadow: 0 0 8px var(--neon-blue);
        }
        
        /* بطاقات المباراة - محسّنة للموبايل */
        .match {
            background: rgba(34, 34, 42, 0.95);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(0,255,255,0.3);
            border-radius: 10px;
            box-shadow: 
                0 4px 12px rgba(0,0,0,0.3),
                inset 0 1px 0 rgba(255,255,255,0.1),
                0 0 15px rgba(0,255,255,0.1);
            width: 100%;
            min-width: 240px;
            max-width: 280px;
            position: relative;
            margin-bottom: 20px;
            z-index: 5;
            flex-shrink: 0;
            transition: all 0.2s ease;
            overflow: hidden;
            touch-action: manipulation;
        }
        
        .match::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--neon-blue), var(--neon-purple), transparent);
        }
        
        .match:active {
            transform: scale(0.98);
        }

        .match-player {
            border-bottom: 1px solid rgba(255,255,255,0.05);
            padding: 0.85rem 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 8px;
            position: relative;
            transition: all 0.2s ease;
            min-height: var(--touch-target-min);
        }
        
        .match-player:last-child { 
            border-bottom: none; 
        }

        .player-name {
            color: var(--text-primary);
            transition: all 0.2s ease;
            font-size: 0.85rem;
            flex: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            line-height: 1.4;
        }
        
        .match-player.winner {
            background: linear-gradient(90deg, rgba(0,255,0,0.15), transparent);
            border-right: 3px solid var(--neon-green);
        }
        
        .match-player.winner .player-name {
            color: var(--neon-green);
            text-shadow: 
                0 0 8px var(--neon-green),
                0 0 15px var(--neon-green);
            font-weight: bold;
        }
        
        .tbd { 
            color: var(--text-secondary); 
            font-style: italic; 
            font-size: 0.8rem;
        }

        /* أزرار محسّنة للموبايل */
        .match-player button {
            background: linear-gradient(135deg, rgba(0,255,255,0.25), rgba(176,38,255,0.2));
            color: var(--neon-blue);
            border: 1.5px solid rgba(0,255,255,0.5);
            border-radius: 8px;
            padding: 0;
            font-family: 'Orbitron', sans-serif;
            font-size: 0.9rem;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 0 10px rgba(0,255,255,0.3),
                inset 0 1px 0 rgba(255,255,255,0.1);
            min-width: var(--touch-target-min);
            min-height: var(--touch-target-min);
            width: var(--touch-target-min);
            height: var(--touch-target-min);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            flex-shrink: 0;
            touch-action: manipulation;
            -webkit-user-select: none;
            user-select: none;
        }
        
        .match-player button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(0,255,255,0.4);
            transform: translate(-50%, -50%);
            transition: width 0.3s ease, height 0.3s ease;
        }
        
        .match-player button:active:not(:disabled) {
            transform: scale(0.92);
        }
        
        .match-player button:active:not(:disabled)::before {
            width: 80px;
            height: 80px;
        }
        
        .match-player button:active:not(:disabled) {
            background: linear-gradient(135deg, var(--neon-green), var(--neon-blue));
            color: var(--bg-dark);
            border-color: var(--neon-green);
            box-shadow: 
                0 0 20px var(--neon-green),
                inset 0 1px 0 rgba(255,255,255,0.3);
        }
        
        .match-player button:disabled {
            background: rgba(50,50,50,0.4);
            color: var(--text-secondary);
            border-color: rgba(255,255,255,0.1);
            box-shadow: none;
            cursor: not-allowed;
            opacity: 0.5;
        }
        
        .match-player button i {
            position: relative;
            z-index: 1;
            transition: transform 0.2s ease;
            font-size: 1.1rem;
        }
        
        .match-player button:active:not(:disabled) i {
            transform: scale(1.15) rotate(10deg);
        }

        /* خطوط الربط - محسّنة */
        .match-line {
            position: absolute;
            background: linear-gradient(90deg, var(--neon-blue), var(--neon-purple));
            box-shadow: 0 0 8px rgba(0,255,255,0.4);
            z-index: 1;
            transition: all 0.2s ease;
        }
        
        .h-line { height: 2px; }
        .v-line { width: 2px; }
        
        /* عناوين الأقسام */
        .section-title {
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple), var(--neon-orange));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: drop-shadow(0 0 15px rgba(0,255,255,0.5));
            position: relative;
            display: inline-block;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--neon-blue), var(--neon-purple), transparent);
            box-shadow: 0 0 8px var(--neon-blue);
        }
        
        /* رسوم متحركة للدخول */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .animate-in {
            animation: fadeInUp 0.5s ease-out forwards;
        }
        
        .animate-in-delay-1 { animation-delay: 0.1s; opacity: 0; }
        .animate-in-delay-2 { animation-delay: 0.2s; opacity: 0; }
        .animate-in-delay-3 { animation-delay: 0.3s; opacity: 0; }
        .animate-in-delay-4 { animation-delay: 0.4s; opacity: 0; }
        
        /* تحسينات استجابة الموبايل */
        @media (max-width: 640px) {
            html {
                font-size: 14px;
            }
            
            .glass-card {
                border-radius: 12px;
                padding: 1rem !important;
            }
            
            .champion-card {
                border-radius: 16px;
                padding: 1.5rem !important;
            }
            
            .match {
                min-width: 220px;
                max-width: 260px;
            }
            
            .round {
                margin-right: 50px;
                min-height: 250px;
            }
            
            .stat-icon {
                font-size: 1.75rem;
                right: 10px;
            }
            
            .stat-value {
                font-size: 2rem !important;
            }
            
            .section-title {
                font-size: 1.75rem !important;
            }
            
            .champion-display {
                font-size: 1.25rem !important;
            }
            
            .round-label {
                font-size: 0.75rem;
                padding: 4px 10px;
            }
            
            .player-name {
                font-size: 0.8rem;
            }
            
            .bracket-container {
                padding: 1.5rem 0.75rem;
            }
            
            .match-player {
                padding: 0.75rem 0.85rem;
            }
        }
        
        @media (min-width: 641px) and (max-width: 768px) {
            .match {
                min-width: 250px;
                max-width: 270px;
            }
        }
        
        @media (min-width: 769px) and (max-width: 1024px) {
            .match {
                min-width: 260px;
                max-width: 280px;
            }
        }
        
        /* تحسينات الأداء */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body class="p-0 m-0">
    <!-- شريط التقدم -->
    <div class="progress-bar-container">
        <div id="progress-bar" class="progress-bar" style="width: 0%"></div>
    </div>

    <div class="flex flex-col min-h-screen">
        <!-- شريط التنقل -->
        <nav class="top-nav flex-shrink-0">
            <div class="max-w-7xl mx-auto px-3 sm:px-6">
                <div class="flex items-center justify-between h-14 sm:h-16">
                    <div class="flex items-center gap-2 sm:gap-3">
                        <div class="relative">
                            <i class="fas fa-trophy text-xl sm:text-2xl text-neon-orange"></i>
                            <div class="absolute inset-0 blur-lg bg-neon-orange opacity-40"></div>
                        </div>
                        <div>
                            <h1 class="text-xs sm:text-base font-bold text-white leading-tight">بطولة مجمع الثقافة للألعاب الإلكترونية</h1>
                            <p class="text-[0.65rem] sm:text-xs text-text-secondary leading-tight">مركز القيادة التكتيكي</p>
                        </div>
                    </div>
                    
                    <!-- قائمة سطح المكتب -->
                    <div class="hidden md:flex">
                        <div class="flex items-center gap-1">
                            <a href="#" id="nav-dashboard" class="nav-link active px-3 py-2 text-sm font-medium" onclick="switchView('dashboard'); return false;">
                                <i class="fas fa-chart-line ml-2"></i>لوحة القيادة
                            </a>
                            <a href="#" id="nav-fifa" class="nav-link px-3 py-2 text-sm font-medium" onclick="switchView('fifa'); return false;">
                                <i class="fas fa-futbol ml-2"></i>FIFA
                            </a>
                            <a href="#" id="nav-rocket" class="nav-link px-3 py-2 text-sm font-medium" onclick="switchView('rocket'); return false;">
                                <i class="fas fa-rocket ml-2"></i>Rocket League
                            </a>
                        </div>
                    </div>
                    
                    <!-- زر القائمة للموبايل -->
                    <button type="button" id="mobile-menu-button" class="md:hidden inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white active:bg-gray-700 focus:outline-none" style="min-width: 44px; min-height: 44px;">
                        <i id="menu-open-icon" class="fas fa-bars text-lg"></i>
                        <i id="menu-close-icon" class="fas fa-times text-lg hidden"></i>
                    </button>
                </div>
            </div>
            
            <!-- قائمة الموبايل -->
            <div class="md:hidden hidden" id="mobile-menu">
                <div class="px-2 pt-2 pb-3 space-y-1 bg-bg-medium bg-opacity-95 backdrop-blur-lg">
                    <a href="#" id="nav-mobile-dashboard" class="nav-link active text-white block px-4 py-3 rounded-md text-base font-medium" onclick="switchView('dashboard'); return false;">
                        <i class="fas fa-chart-line ml-2"></i>لوحة القيادة
                    </a>
                    <a href="#" id="nav-mobile-fifa" class="nav-link text-gray-300 block px-4 py-3 rounded-md text-base font-medium" onclick="switchView('fifa'); return false;">
                        <i class="fas fa-futbol ml-2"></i>FIFA
                    </a>
                    <a href="#" id="nav-mobile-rocket" class="nav-link text-gray-300 block px-4 py-3 rounded-md text-base font-medium" onclick="switchView('rocket'); return false;">
                        <i class="fas fa-rocket ml-2"></i>Rocket League
                    </a>
                </div>
            </div>
        </nav>

        <!-- المحتوى الرئيسي -->
        <main class="flex-1 overflow-y-auto p-3 sm:p-6 md:p-10 relative z-10">
            <!-- لوحة القيادة -->
            <div id="view-dashboard">
                <header class="mb-6 sm:mb-8 animate-in">
                    <h2 class="section-title text-2xl sm:text-3xl md:text-4xl font-bold mb-2">ملخص النظام</h2>
                    <p class="text-sm sm:text-base md:text-lg text-text-secondary mt-3">مراقبة حية ومباشرة لتقدم البطولة</p>
                </header>
                
                <div class="grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 md:gap-6 mb-8 sm:mb-10">
                    <div class="glass-card p-4 sm:p-5 md:p-6 animate-in animate-in-delay-1">
                        <i class="fas fa-users stat-icon"></i>
                        <div class="text-text-secondary text-xs sm:text-sm mb-1 sm:mb-2 font-medium">إجمالي المشاركين</div>
                        <div id="total-players-stat" class="stat-value text-2xl sm:text-3xl md:text-4xl font-bold">0</div>
                    </div>
                    
                    <div class="glass-card p-4 sm:p-5 md:p-6 animate-in animate-in-delay-2">
                        <i class="fas fa-futbol stat-icon" style="color: var(--neon-green);"></i>
                        <div class="text-text-secondary text-xs sm:text-sm mb-1 sm:mb-2 font-medium">لاعبو FIFA</div>
                        <div id="fifa-players-stat" class="stat-value text-2xl sm:text-3xl md:text-4xl font-bold" style="background: linear-gradient(135deg, var(--neon-green), var(--neon-blue)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">0</div>
                    </div>
                    
                    <div class="glass-card p-4 sm:p-5 md:p-6 animate-in animate-in-delay-3">
                        <i class="fas fa-rocket stat-icon" style="color: var(--neon-orange);"></i>
                        <div class="text-text-secondary text-xs sm:text-sm mb-1 sm:mb-2 font-medium">لاعبو Rocket League</div>
                        <div id="rocket-players-stat" class="stat-value text-2xl sm:text-3xl md:text-4xl font-bold" style="background: linear-gradient(135deg, var(--neon-orange), var(--neon-purple)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">0</div>
                    </div>
                    
                    <div class="glass-card p-4 sm:p-5 md:p-6 animate-in animate-in-delay-4">
                        <i class="fas fa-gamepad stat-icon"></i>
                        <div class="text-text-secondary text-xs sm:text-sm mb-1 sm:mb-2 font-medium">المباريات المتبقية</div>
                        <div id="matches-left-stat" class="stat-value text-2xl sm:text-3xl md:text-4xl font-bold">0</div>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 md:gap-8">
                    <div class="champion-card p-6 sm:p-7 md:p-8 text-center animate-in">
                        <div class="mb-3 sm:mb-4">
                            <i class="fas fa-crown text-3xl sm:text-4xl mb-2 sm:mb-3" style="color: var(--neon-green); filter: drop-shadow(0 0 15px var(--neon-green));"></i>
                            <h3 class="text-xl sm:text-2xl font-bold" style="color: var(--neon-green); text-shadow: 0 0 15px var(--neon-green);">بطل FIFA</h3>
                        </div>
                        <div id="fifa-champion-display" class="champion-display text-xl sm:text-2xl md:text-3xl font-bold tbd p-4 sm:p-5 md:p-6">... لم يتحدد بعد ...</div>
                    </div>
                    
                    <div class="champion-card p-6 sm:p-7 md:p-8 text-center animate-in" style="border-color: rgba(255,140,0,0.3); box-shadow: 0 8px 32px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.15), 0 0 40px rgba(255,140,0,0.2);">
                        <div class="mb-3 sm:mb-4">
                            <i class="fas fa-trophy text-3xl sm:text-4xl mb-2 sm:mb-3" style="color: var(--neon-orange); filter: drop-shadow(0 0 15px var(--neon-orange));"></i>
                            <h3 class="text-xl sm:text-2xl font-bold" style="color: var(--neon-orange); text-shadow: 0 0 15px var(--neon-orange);">بطل Rocket League</h3>
                        </div>
                        <div id="rocket-champion-display" class="champion-display text-xl sm:text-2xl md:text-3xl font-bold tbd p-4 sm:p-5 md:p-6" style="color: var(--neon-orange); text-shadow: 0 0 10px var(--neon-orange), 0 0 20px var(--neon-orange), 0 0 30px var(--neon-orange);">... لم يتحدد بعد ...</div>
                    </div>
                </div>
            </div>

            <!-- جدول FIFA -->
            <div id="view-fifa" class="hidden">
                <header class="mb-6 sm:mb-8 animate-in">
                    <h2 class="section-title text-2xl sm:text-3xl md:text-4xl font-bold mb-2" style="background: linear-gradient(135deg, var(--neon-green), var(--neon-blue)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">جدول بطولة FIFA</h2>
                    <p class="text-sm sm:text-base md:text-lg text-text-secondary mt-3">تابع مسار المنافسة</p>
                </header>
                <div id="fifa-bracket-container" class="bracket-container animate-in"></div>
            </div>

            <!-- جدول Rocket League -->
            <div id="view-rocket" class="hidden">
                <header class="mb-6 sm:mb-8 animate-in">
                    <h2 class="section-title text-2xl sm:text-3xl md:text-4xl font-bold mb-2" style="background: linear-gradient(135deg, var(--neon-orange), var(--neon-purple)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">جدول بطولة Rocket League</h2>
                    <p class="text-sm sm:text-base md:text-lg text-text-secondary mt-3">تابع مسار المنافسة</p>
                </header>
                <div id="rocket-bracket-container" class="bracket-container animate-in"></div>
            </div>
        </main>
    </div>

    <script>
        const rawData = [
            { name: "عبد الملك اسماعيل عيسى صبيخي", id: "1154464224", grade: "ثالث متوسط", game: "كرة القدم (فيفا)" },
            { name: "راكان عبدالله علي عسيري", id: "1165909050", grade: "أول متوسط", game: "روكيت ليج" },
            { name: "جابر محمد جابر عسيري", id: "1152842892", grade: "ثالث متوسط", game: "كرة القدم (فيفا)" },
            { name: "ريان إبراهيم علي عسيري", id: "7", grade: "أول متوسط", game: "كرة القدم (فيفa)" },
            { name: "عزام محمد احمد النجعي", id: "1158897197", grade: "ثاني متوسط", game: "روكيت ليج" },
            { name: "ماطر احمد ماطر عسيري", id: "1164702126", grade: "أول متوسط", game: "كرة القدم (فيفا)" },
            { name: "أحمد سلطان محمد ال محنش", id: "1166413862", grade: "أول متوسط", game: "روكيت ليج" },
            { name: "عبدالرحمن احمد صهيف عسيري", id: "1158913218", grade: "ثاني متوسط", game: "روكيت ليج" },
            { name: "نايف علي سعيد الفاحم", id: "1159924388", grade: "ثاني متوسط", game: "كرة القدم (فيفا)" },
            { name: "حازم موسى محمد عسيري", id: "1177411590", grade: "رابع", game: "كرة القدم (فيفا)" },
            { name: "حازم موسى محمد عسيري", id: "1177411590", grade: "رابع", game: "روكيت ليج" },
            { name: "تميم علي احمد محمد فايع حسن", id: "1166187573", grade: "أول متوسط", game: "كرة القدم (فيفا)" },
            { name: "سعيد أحمد سعيد الحيدي", id: "1165932227", grade: "أول متوسط", game: "روكيت ليج" },
            { name: "سعود أحمد سعيد الحيدي", id: "1171149543", grade: "سادس", game: "روكيت ليج" },
            { name: "اياد محمد عبدالله راتي", id: "1162138851", grade: "ثاني متوسط", game: "روكيت ليج" },
            { name: "عبدالعزيز حاطر علي عسيري", id: "1159233251", grade: "ثاني متوسط", game: "كرة القدم (فيفا)" },
            { name: "ايمن حاضر علي عسيري", id: "1153410897", grade: "ثاني متوسط", game: "كرة القدم (فيفا)" },
            { name: "مهدي جمال فائع عسيري", id: "1154995177", grade: "ثالث متوسط", game: "كرة القدم (فيفا)" },
            { name: "يحيى محمد مفرح", id: "1151960224", grade: "ثالث متوسط", game: "كرة القدم (فيفا)" },
            { name: "راشد احمد مفرح", id: "rashid-ahmed", grade: "ثاني متوسط", game: "كرة القدم (فيفا)" },
            { name: "عبدالله محمد", id: "1158207769", grade: "ثالث متوسط", game: "كرة القدم (فيفا)" },
            { name: "مشافي مشني مشافي العرافي", id: "1157708452", grade: "ثالث متوسط", game: "كرة القدم (فيفا)" },
        ];
        
        const uniquePlayers = Array.from(new Set(rawData.map(p => JSON.stringify(p)))).map(s => JSON.parse(s));
        
        const state = {
            fifa: { players: uniquePlayers.filter(p => p.game.includes('فيفا')), matches: [] },
            rocket: { players: uniquePlayers.filter(p => p.game.includes('روكيت')), matches: [] }
        };

        // إدارة القائمة المحمولة
        const mobileMenu = document.getElementById('mobile-menu');
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const openIcon = document.getElementById('menu-open-icon');
        const closeIcon = document.getElementById('menu-close-icon');

        mobileMenuButton.addEventListener('click', (e) => {
            e.preventDefault();
            mobileMenu.classList.toggle('hidden');
            openIcon.classList.toggle('hidden');
            closeIcon.classList.toggle('hidden');
        });

        // التبديل بين الصفحات
        function switchView(viewName) {
            document.querySelectorAll('[id^="view-"]').forEach(v => v.classList.add('hidden'));
            document.getElementById(`view-${viewName}`).classList.remove('hidden');
            
            // تحديث روابط سطح المكتب
            document.querySelectorAll('.top-nav .nav-link').forEach(n => n.classList.remove('active'));
            const desktopLink = document.getElementById(`nav-${viewName}`);
            if(desktopLink) desktopLink.classList.add('active');

            // تحديث روابط الموبايل
            document.querySelectorAll('#mobile-menu .nav-link').forEach(n => n.classList.remove('active'));
            const mobileLink = document.getElementById(`nav-mobile-${viewName}`);
            if(mobileLink) mobileLink.classList.add('active');

            // إغلاق قائمة الموبايل
            if (!mobileMenu.classList.contains('hidden')) {
                mobileMenu.classList.add('hidden');
                openIcon.classList.remove('hidden');
                closeIcon.classList.add('hidden');
            }
            
            // التمرير للأعلى
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // إنشاء HTML للاعب
        function createPlayerHTML(player, matchId, slot) {
            const playerName = player ? player.name : '<i class="tbd">بانتظار المتأهل</i>';
            const isBye = player && player.name === 'BYE';
            const isDisabled = !player || isBye;
            return `<div id="${matchId}-p${slot}" class="match-player ${isBye ? 'bg-gray-800 opacity-50' : ''}">
                        <span class="player-name">${playerName}</span>
                        <button onclick="declareWinner('${matchId}', ${slot})" ${isDisabled ? 'disabled' : ''} aria-label="اختيار ${playerName} كفائز">
                            <i class="fas fa-crown"></i>
                        </button>
                    </div>`;
        }

        // توليد جدول البطولة
        function generateBracket(gameKey) {
            const container = document.getElementById(`${gameKey}-bracket-container`);
            const bracketData = state[gameKey];
            container.innerHTML = '';
            bracketData.matches = [];

            let players = [...bracketData.players];
            let targetSize = 2;
            while(targetSize < players.length) targetSize *= 2;
            while(players.length < targetSize) {
                players.push({name: 'BYE', id: `bye-${players.length}-${gameKey}`, grade: 'BYE', game: gameKey});
            }
            
            let currentRoundSources = players.map(p => ({ player: p })); 
            let roundNum = 1;
            
            while(currentRoundSources.length > 1) {
                const roundDiv = document.createElement('div');
                roundDiv.className = 'round';
                
                // إضافة تسمية الدور
                const roundLabel = document.createElement('div');
                roundLabel.className = 'round-label';
                if (currentRoundSources.length === 2) {
                    roundLabel.textContent = 'النهائي';
                } else if (currentRoundSources.length === 4) {
                    roundLabel.textContent = 'نصف النهائي';
                } else if (currentRoundSources.length === 8) {
                    roundLabel.textContent = 'ربع النهائي';
                } else {
                    roundLabel.textContent = `الدور ${roundNum}`;
                }
                roundDiv.appendChild(roundLabel);
                
                const nextRoundSources = [];
                for(let i=0; i < currentRoundSources.length / 2; i++) {
                    const s1 = currentRoundSources[i*2];
                    const s2 = currentRoundSources[i*2+1];
                    const matchId = `${gameKey}-r${roundNum}-m${i}`;
                    
                    const matchDiv = document.createElement('div');
                    matchDiv.className = 'match';
                    matchDiv.id = matchId;
                    matchDiv.innerHTML = createPlayerHTML(s1.player, matchId, 1) + createPlayerHTML(s2.player, matchId, 2);
                    
                    const matchData = { matchId, p1Source: s1, p2Source: s2, winner: null };
                    bracketData.matches.push(matchData);
                    nextRoundSources.push({ match: matchData });
                    roundDiv.appendChild(matchDiv);
                }
                container.appendChild(roundDiv);
                currentRoundSources = nextRoundSources;
                roundNum++;
            }
            
            setTimeout(() => drawBracketLines(gameKey), 100);
            
            // معالجة BYE تلقائياً
            bracketData.matches.forEach(match => {
                if (match.p1Source.player && match.p1Source.player.name === 'BYE') {
                    declareWinner(match.matchId, 2, true);
                } else if (match.p2Source.player && match.p2Source.player.name === 'BYE') {
                    declareWinner(match.matchId, 1, true);
                }
            });
            updateStats();
        }
        
        // إعلان الفائز
        function declareWinner(matchId, winnerSlot, isAuto = false) {
            const gameKey = matchId.startsWith('fifa') ? 'fifa' : 'rocket';
            const bracketData = state[gameKey];

            const currentMatch = bracketData.matches.find(m => m.matchId === matchId);
            if (!currentMatch || currentMatch.winner) return;

            const winnerSource = winnerSlot === 1 ? currentMatch.p1Source : currentMatch.p2Source;
            currentMatch.winner = winnerSource.player || (winnerSource.match ? winnerSource.match.winner : null);
            
            if (!currentMatch.winner) return;

            const winnerPlayerDiv = document.getElementById(`${matchId}-p${winnerSlot}`);
            if (winnerPlayerDiv) winnerPlayerDiv.classList.add('winner');
            
            const matchDiv = document.getElementById(matchId);
            if (matchDiv) matchDiv.querySelectorAll('button').forEach(b => b.disabled = true);

            const nextMatch = bracketData.matches.find(m => 
                (m.p1Source.match && m.p1Source.match.matchId === matchId) || 
                (m.p2Source.match && m.p2Source.match.matchId === matchId)
            );
            
            if (nextMatch) {
                const nextSlot = (nextMatch.p1Source.match && nextMatch.p1Source.match.matchId === matchId) ? 1 : 2;
                nextMatch[nextSlot === 1 ? 'p1Source' : 'p2Source'].player = currentMatch.winner;

                const nextPlayerDiv = document.getElementById(`${nextMatch.matchId}-p${nextSlot}`);
                if (nextPlayerDiv) {
                    nextPlayerDiv.querySelector('.player-name').innerHTML = currentMatch.winner.name;
                    nextPlayerDiv.querySelector('.player-name').classList.remove('tbd');
                    const nextButton = nextPlayerDiv.querySelector('button');
                    if (nextButton) {
                        nextButton.setAttribute('aria-label', `اختيار ${currentMatch.winner.name} كفائز`);
                    }
                }
                
                const otherSource = nextSlot === 1 ? nextMatch.p2Source : nextMatch.p1Source;
                if (otherSource.player || (otherSource.match && otherSource.match.winner)) {
                    document.getElementById(nextMatch.matchId).querySelectorAll('button').forEach(b => b.disabled = false);
                }

                const otherPlayer = otherSource.player || (otherSource.match ? otherSource.match.winner : null);
                if (otherPlayer && otherPlayer.name === 'BYE') {
                    declareWinner(nextMatch.matchId, nextSlot, true);
                }
            } else { 
                document.getElementById(`${gameKey}-champion-display`).textContent = currentMatch.winner.name;
                document.getElementById(`${gameKey}-champion-display`).classList.remove('tbd');
            }
            
            if (!isAuto) {
                updateStats();
                updateProgressBar();
            }
        }
        
        // رسم الخطوط الرابطة
        function drawBracketLines(gameKey) {
            const container = document.getElementById(`${gameKey}-bracket-container`);
            if (!container) return;

            container.querySelectorAll('.match-line').forEach(line => line.remove());

            const rounds = Array.from(container.querySelectorAll('.round'));
            if (rounds.length < 2) return;

            for (let i = 0; i < rounds.length - 1; i++) {
                const currentMatches = Array.from(rounds[i].querySelectorAll('.match'));
                const nextMatches = Array.from(rounds[i+1].querySelectorAll('.match'));

                for (let j = 0; j < currentMatches.length / 2; j++) {
                    const topMatch = currentMatches[j * 2];
                    const bottomMatch = currentMatches[j * 2 + 1];
                    const nextMatch = nextMatches[j];

                    if (!topMatch || !bottomMatch || !nextMatch) continue;
                    
                    const lineHalfWidth = window.innerWidth < 640 ? 40 : 50;
                    const midX = topMatch.offsetLeft + topMatch.offsetWidth;
                    
                    const startY = topMatch.offsetTop + topMatch.offsetHeight / 2;
                    const hLine1 = document.createElement('div');
                    hLine1.className = 'match-line h-line';
                    hLine1.style.cssText = `top: ${startY - 1}px; left: ${midX}px; width: ${lineHalfWidth}px;`;
                    container.appendChild(hLine1);

                    const endY = bottomMatch.offsetTop + bottomMatch.offsetHeight / 2;
                    const hLine2 = document.createElement('div');
                    hLine2.className = 'match-line h-line';
                    hLine2.style.cssText = `top: ${endY - 1}px; left: ${midX}px; width: ${lineHalfWidth}px;`;
                    container.appendChild(hLine2);
                    
                    const vLine = document.createElement('div');
                    vLine.className = 'match-line v-line';
                    vLine.style.cssText = `top: ${startY}px; left: ${midX + lineHalfWidth - 1}px; height: ${endY - startY}px;`;
                    container.appendChild(vLine);

                    const nextMatchY = nextMatch.offsetTop + nextMatch.offsetHeight / 2;
                    const hLine3 = document.createElement('div');
                    hLine3.className = 'match-line h-line';
                    hLine3.style.cssText = `top: ${nextMatchY - 1}px; left: ${midX + lineHalfWidth}px; width: ${lineHalfWidth}px;`;
                    container.appendChild(hLine3);
                }
            }
        }
        
        // تحديث الإحصائيات
        function updateStats() {
            const totalFifaPlayers = state.fifa.players.filter(p => p.name !== 'BYE').length;
            const totalRocketPlayers = state.rocket.players.filter(p => p.name !== 'BYE').length;
            
            const totalFifaMatches = totalFifaPlayers > 1 ? totalFifaPlayers - 1 : 0;
            const totalRocketMatches = totalRocketPlayers > 1 ? totalRocketPlayers - 1 : 0;
            
            const playedFifaMatches = state.fifa.matches.filter(m => m.winner && m.p1Source.player?.name !== 'BYE' && m.p2Source.player?.name !== 'BYE').length;
            const playedRocketMatches = state.rocket.matches.filter(m => m.winner && m.p1Source.player?.name !== 'BYE' && m.p2Source.player?.name !== 'BYE').length;
            
            document.getElementById('total-players-stat').textContent = uniquePlayers.filter(p => p.name !== 'BYE').length;
            document.getElementById('fifa-players-stat').textContent = totalFifaPlayers;
            document.getElementById('rocket-players-stat').textContent = totalRocketPlayers;
            document.getElementById('matches-left-stat').textContent = (totalFifaMatches + totalRocketMatches) - (playedFifaMatches + playedRocketMatches);
        }
        
        // تحديث شريط التقدم
        function updateProgressBar() {
            const totalFifaPlayers = state.fifa.players.filter(p => p.name !== 'BYE').length;
            const totalRocketPlayers = state.rocket.players.filter(p => p.name !== 'BYE').length;
            
            const totalFifaMatches = totalFifaPlayers > 1 ? totalFifaPlayers - 1 : 0;
            const totalRocketMatches = totalRocketPlayers > 1 ? totalRocketPlayers - 1 : 0;
            const totalMatches = totalFifaMatches + totalRocketMatches;
            
            const playedFifaMatches = state.fifa.matches.filter(m => m.winner && m.p1Source.player?.name !== 'BYE' && m.p2Source.player?.name !== 'BYE').length;
            const playedRocketMatches = state.rocket.matches.filter(m => m.winner && m.p1Source.player?.name !== 'BYE' && m.p2Source.player?.name !== 'BYE').length;
            const playedMatches = playedFifaMatches + playedRocketMatches;
            
            const progressPercentage = totalMatches > 0 ? (playedMatches / totalMatches) * 100 : 0;
            document.getElementById('progress-bar').style.width = progressPercentage + '%';
        }

        // تهيئة التطبيق
        window.addEventListener('DOMContentLoaded', () => {
            generateBracket('fifa');
            generateBracket('rocket');
            switchView('dashboard'); 
            updateStats();
            updateProgressBar();
        });

        // إعادة رسم الخطوط عند تغيير حجم النافذة
        let resizeTimeout;
        window.addEventListener('resize', () => {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(() => {
                drawBracketLines('fifa');
                drawBracketLines('rocket');
            }, 250);
        });
        
        // منع السحب الأفقي الزائد
        let startX = 0;
        document.addEventListener('touchstart', (e) => {
            startX = e.touches[0].pageX;
        }, { passive: true });
        
        document.addEventListener('touchmove', (e) => {
            const touch = e.touches[0];
            const change = startX - touch.pageX;
            if (Math.abs(change) < 10 && !e.target.closest('.bracket-container')) {
                e.preventDefault();
            }
        }, { passive: false });
    </script>
</body>
</html>
